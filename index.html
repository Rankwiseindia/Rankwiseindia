<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rank Predictor & Marks Calculator - Naveen Rank Mitra</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            margin: 0;
            padding: 20px;
            color: #333;
        }
        .container {
            max-width: 750px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }
        h1 {
            text-align: center;
            color: #1565c0;
            margin-bottom: 10px;
        }
        p.subtitle {
            text-align: center;
            color: #555;
            margin-bottom: 30px;
        }
        label {
            display: block;
            margin: 15px 0 6px;
            font-weight: bold;
            color: #333;
        }
        input, select {
            width: 100%;
            padding: 12px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-sizing: border-box;
        }
        button {
            background: #4caf50;
            color: white;
            border: none;
            padding: 15px;
            font-size: 18px;
            width: 100%;
            border-radius: 6px;
            cursor: pointer;
            margin: 20px 0;
            font-weight: bold;
        }
        button:hover {
            background: #388e3c;
        }
        #pdfLink {
            margin: 10px 0;
            font-size: 16px;
            word-break: break-all;
        }
        #resultSection {
            margin-top: 30px;
            padding: 20px;
            background: #e8f5e9;
            border-radius: 10px;
            text-align: center;
            display: none;
        }
        #marks {
            font-size: 36px;
            font-weight: bold;
            color: #2e7d32;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 30px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: center;
        }
        th {
            background: #1565c0;
            color: white;
        }
        .note {
            font-size: 14px;
            color: #777;
            text-align: center;
            margin-top: 30px;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Rank Predictor & Marks Calculator</h1>
        <p class="subtitle">SSC, RRB, Police exams के लिए marks calculate करो, save करो और rank estimate देखो (Naveen Rank Mitra)</p>

        <label>Answer Key URL पेस्ट करो (Official PDF):</label>
        <input type="url" id="answerKeyUrl" placeholder="https://ssc.gov.in/.../answer-key.pdf">

        <div id="pdfLink"></div>

        <label>Exam चुनें (Marking Scheme):</label>
        <select id="examScheme">
            <option value="2,0.5,100">SSC CGL Tier-1 (+2 सही, -0.5 गलत, 100 प्रश्न)</option>
            <option value="1,0.25,100">SSC CHSL (+1 सही, -0.25 गलत, 100 प्रश्न)</option>
            <option value="1,0,100">RRB NTPC (+1 सही, कोई नेगेटिव नहीं, 100 प्रश्न)</option>
            <option value="1,0.33,100">Delhi Police / कुछ अन्य (+1 सही, -1/3 गलत)</option>
        </select>

        <label>Category:</label>
        <select id="category">
            <option>General</option>
            <option>OBC</option>
            <option>SC</option>
            <option>ST</option>
            <option>EWS</option>
        </select>

        <label>सही जवाब (Correct):</label>
        <input type="number" id="correct" min="0" placeholder="PDF से देखकर डालो" required>

        <label>गलत जवाब (Wrong):</label>
        <input type="number" id="wrong" min="0" placeholder="PDF से देखकर डालो" required>

        <button onclick="calculateAndSave()">Calculate, Save & Predict Rank</button>

        <div id="resultSection">
            <div id="marks">Marks: --</div>
            <div id="details"></div>
            <div id="rankEstimate"></div>
            <div id="cutoffEstimate"></div>
        </div>

        <h3>Leaderboard (तुम्हारे Saves से)</h3>
        <table id="leaderboard">
            <thead>
                <tr>
                    <th>Rank</th>
                    <th>Marks</th>
                    <th>Category</th>
                    <th>Date</th>
                </tr>
            </thead>
            <tbody id="leaderBody"></tbody>
        </table>

        <p class="note">Note: ये सब तुम्हारे ब्राउजर में save होता है (localStorage)। Real crowd data और ऑटो PDF parse के लिए server (PHP/Node) चाहिए। GitHub Pages पर डालकर फ्री होस्ट कर सकते हो।</p>
    </div>

    <script>
        function calculateAndSave() {
            const url = document.getElementById('answerKeyUrl').value.trim();
            if (url) {
                document.getElementById('pdfLink').innerHTML = `<strong>PDF लिंक:</strong> <a href="${url}" target="_blank" style="color:#1565c0;">खोलो और सही/गलत काउंट करो</a>`;
            }

            const correct = parseInt(document.getElementById('correct').value) || 0;
            const wrong = parseInt(document.getElementById('wrong').value) || 0;

            if (correct === 0 && wrong === 0) {
                alert("Correct या Wrong डालो!");
                return;
            }

            const scheme = document.getElementById('examScheme').value.split(',');
            const positive = parseFloat(scheme[0]);
            const negative = parseFloat(scheme[1]);
            const totalQ = parseInt(scheme[2]);
            const unattempted = totalQ - correct - wrong;

            const marks = (correct * positive) - (wrong * negative);

            const category = document.getElementById('category').value;

            // Result दिखाओ
            document.getElementById('marks').innerHTML = `Marks: ${marks.toFixed(2)}`;
            document.getElementById('details').innerHTML = `
                सही: ${correct} × ${positive} = ${correct * positive}<br>
                गलत: ${wrong} × \( {negative} = - \){wrong * negative}<br>
                Unattempted: ${unattempted}<br>
                Category: ${category}
            `;

            // Save
            const entry = {
                marks: marks.toFixed(2),
                category: category,
                date: new Date().toLocaleString('hi-IN')
            };
            let history = JSON.parse(localStorage.getItem('rankCalculatorHistory')) || [];
            history.push(entry);
            localStorage.setItem('rankCalculatorHistory', JSON.stringify(history));

            // Rank & Cutoff estimate
            const sorted = history.slice().sort((a, b) => parseFloat(b.marks) - parseFloat(a.marks));
            const yourIndex = sorted.findIndex(e => e.marks === entry.marks && e.date === entry.date);
            const yourRank = yourIndex + 1;
            const percentile = ((history.length - yourRank + 1) / history.length * 100).toFixed(1);

            let avgMarks = history.reduce((sum, e) => sum + parseFloat(e.marks), 0) / history.length || 0;
            avgMarks = avgMarks.toFixed(2);

            document.getElementById('rankEstimate').innerHTML = `Estimated Rank: ${yourRank} / ${history.length} (Percentile: ${percentile}%)`;
            document.getElementById('cutoffEstimate').innerHTML = `Estimated Cutoff (average): ${avgMarks}`;

            document.getElementById('resultSection').style.display = 'block';

            updateLeaderboard();
        }

        function updateLeaderboard() {
            let history = JSON.parse(localStorage.getItem('rankCalculatorHistory')) || [];
            history.sort((a, b) => parseFloat(b.marks) - parseFloat(a.marks));

            let tbody = document.getElementById('leaderBody');
            tbody.innerHTML = '';
            history.forEach((item, index) => {
                let row = `<tr>
                    <td>${index + 1}</td>
                    <td>${item.marks}</td>
                    <td>${item.category}</td>
                    <td>${item.date}</td>
                </tr>`;
                tbody.innerHTML += row;
            });

            if (history.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4">Calculate करके save करो, leaderboard दिखेगा</td></tr>';
            }
        }

        // Page load पर leaderboard लोड
        window.onload = updateLeaderboard;
    </script>
</body>
</html>
